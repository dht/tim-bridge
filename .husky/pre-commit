#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Exit if package.json is already staged (prevents infinite bump loop)
if git diff --name-only --cached | grep -q "package.json"; then
  echo "⏭  version already bumped in this commit, skipping."
  exit 0
fi

# Only bump when needed
echo "⬆️  Bumping patch version..."
npm version patch --no-git-tag-version

# Stage modified files
git add package.json package-lock.json 2>/dev/null || true
